{"ast":null,"code":"var _jsxFileName = \"/Users/zoekatz/apps/cai-app/src/components/FeaturesModal/FeaturesModal.tsx\";\nimport React, { useCallback, useContext, useEffect, useState, useMemo } from 'react';\nimport FeaturesTable from '../FeaturesTable/FeaturesTable';\nimport { fetchFeatures, fetchModelMetadata } from '../../lib/mock-api';\nimport FeaturesFilters from \"../FeaturesFilters/FeaturesFilters\";\nimport './FeaturesModal.scss';\nimport FeaturesContext from \"../../FeaturesContext\";\nimport { Select } from '@material-ui/core';\n\nconst FeaturesModal = () => {\n  const [featuresFlatData, setFeaturesFlatData] = useState([]);\n  const [featuresModelMetadata, setFeaturesModelMetadata] = useState({\n    labels: [],\n    domains: []\n  });\n  const [featuresColumns, setFeaturesColumns] = useState([]);\n  const {\n    dispatch,\n    query\n  } = useContext(FeaturesContext);\n  const featuresColumnArr = useMemo(() => {\n    return [{\n      Header: 'NAME',\n      accessor: 'name'\n    }, {\n      Header: 'VARIABLE ID',\n      accessor: 'varId'\n    }, {\n      Header: 'DESCRIPTION',\n      accessor: 'description'\n    }, {\n      Header: 'DOMAINS',\n      accessor: (originalRow, rowIndex) => originalRow.domains,\n      Cell: row => {\n        console.log(row, \"featuresModelMetadata\");\n        return /*#__PURE__*/React.createElement(\"select\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 37,\n            columnNumber: 21\n          }\n        }, /*#__PURE__*/React.createElement(\"option\", {\n          value: \"\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 38,\n            columnNumber: 25\n          }\n        }, `${row.value.length} selected`), featuresModelMetadata && featuresModelMetadata.domains.map((val, index) => {\n          return /*#__PURE__*/React.createElement(\"option\", {\n            value: val,\n            key: index,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 40,\n              columnNumber: 36\n            }\n          }, val);\n        }));\n      }\n    }, {\n      Header: 'LABELS',\n      accessor: 'labels',\n      Cell: row => {\n        return /*#__PURE__*/React.createElement(Select, {\n          labelId: \"select-labels\",\n          id: \"select-labels\",\n          multiple: true,\n          value: `${row.value.length} selected`,\n          onChange: () => {},\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 50,\n            columnNumber: 25\n          }\n        }, featuresModelMetadata.labels.map((label, index) => {\n          return /*#__PURE__*/React.createElement(\"option\", {\n            key: index,\n            value: label,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 58,\n              columnNumber: 40\n            }\n          }, label);\n        }));\n        {\n          /*<select>*/\n        }\n        {\n          /*    <option value=\"\">{`${row.value.length} selected`}</option>*/\n        }\n        {\n          /*    {featuresModelMetadata && featuresModelMetadata.labels.map((val, index) => {*/\n        }\n        {\n          /*        return <option value={val} key={index}>{val}</option>;*/\n        }\n        {\n          /*    })}*/\n        }\n        {\n          /*</select>*/\n        }\n      }\n    }, {\n      Header: 'VALUE',\n      accessor: 'value'\n    }];\n  }, [featuresModelMetadata.labels, featuresModelMetadata.domains]);\n  const getFeaturesData = useCallback(() => {\n    return fetchFeatures();\n  }, []);\n  const getModeMetadata = useCallback(() => {\n    return fetchModelMetadata();\n  }, []);\n  useEffect(() => {\n    getFeaturesData().then(res => {\n      if (res) {\n        setFeaturesFlatData(res.map(item => {\n          return { ...item,\n            ...item.attributes\n          };\n        }));\n      }\n    }).catch(err => {\n      console.log(err);\n    });\n    getModeMetadata().then(res => {\n      if (res) {\n        setFeaturesModelMetadata(res);\n      }\n    }).catch(err => {\n      console.log(err);\n    });\n  }, []);\n  useEffect(() => {\n    setFeaturesColumns(featuresColumnArr);\n  }, [featuresFlatData, featuresModelMetadata]);\n  const filterFeaturesData = useMemo(() => {\n    return featuresFlatData.filter(feature => {\n      return feature.name && feature.name.toLowerCase().indexOf(query.toLowerCase()) > -1 || feature.description && feature.description.toLowerCase().indexOf(query.toLowerCase()) > -1;\n    });\n  }, [featuresFlatData, query]);\n  return !!featuresFlatData.length ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"features-modal\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    onClick: () => {\n      dispatch({\n        type: 'SET_IS_DIALOG_OPEN',\n        payload: {\n          isDialogOpen: false\n        }\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 13\n    }\n  }, \"X\"), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(FeaturesFilters, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(FeaturesTable, {\n    columns: featuresColumns,\n    data: filterFeaturesData,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 17\n    }\n  }))) : /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 9\n    }\n  }, \"Loading...\");\n};\n\nexport default FeaturesModal;","map":{"version":3,"sources":["/Users/zoekatz/apps/cai-app/src/components/FeaturesModal/FeaturesModal.tsx"],"names":["React","useCallback","useContext","useEffect","useState","useMemo","FeaturesTable","fetchFeatures","fetchModelMetadata","FeaturesFilters","FeaturesContext","Select","FeaturesModal","featuresFlatData","setFeaturesFlatData","featuresModelMetadata","setFeaturesModelMetadata","labels","domains","featuresColumns","setFeaturesColumns","dispatch","query","featuresColumnArr","Header","accessor","originalRow","rowIndex","Cell","row","console","log","value","length","map","val","index","label","getFeaturesData","getModeMetadata","then","res","item","attributes","catch","err","filterFeaturesData","filter","feature","name","toLowerCase","indexOf","description","type","payload","isDialogOpen"],"mappings":"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","sourcesContent":["import React, {useCallback, useContext, useEffect, useState, useMemo} from 'react';\nimport FeaturesTable from '../FeaturesTable/FeaturesTable';\nimport {fetchFeatures, fetchModelMetadata} from '../../lib/mock-api';\nimport {ICrFlatNode, IModelMetadata, IColumnNode} from \"../../lib/types\";\nimport FeaturesFilters from \"../FeaturesFilters/FeaturesFilters\";\nimport './FeaturesModal.scss';\nimport FeaturesContext from \"../../FeaturesContext\";\nimport { Select } from '@material-ui/core';\n\n\nconst FeaturesModal = () => {\n    const [featuresFlatData, setFeaturesFlatData] = useState<ICrFlatNode[]>([]);\n    const [featuresModelMetadata, setFeaturesModelMetadata] = useState<IModelMetadata>({labels: [], domains: []});\n    const [featuresColumns, setFeaturesColumns] = useState<IColumnNode[]>([]);\n    const {dispatch, query} = useContext(FeaturesContext);\n\n    const featuresColumnArr = useMemo(() => {\n        return [\n            {\n                Header: 'NAME',\n                accessor: 'name',\n            },\n            {\n                Header: 'VARIABLE ID',\n                accessor: 'varId',\n            },\n            {\n                Header: 'DESCRIPTION',\n                accessor: 'description',\n            },\n            {\n                Header: 'DOMAINS',\n                accessor: (originalRow: any, rowIndex: any) => originalRow.domains,\n                Cell: (row: any) => {\n                    console.log(row, \"featuresModelMetadata\")\n                    return (\n                    <select>\n                        <option value=\"\">{`${row.value.length} selected`}</option>\n                        {featuresModelMetadata && featuresModelMetadata.domains.map((val, index) => {\n                            return <option value={val} key={index}>{val}</option>;\n                        })}\n                    </select>\n                )}\n            },\n            {\n                Header: 'LABELS',\n                accessor: 'labels',\n                Cell: (row: any) => {\n                    return (\n                        <Select\n                            labelId=\"select-labels\"\n                            id=\"select-labels\"\n                            multiple\n                            value={`${row.value.length} selected`}\n                            onChange={() => {}}\n                        >\n                            {featuresModelMetadata.labels.map((label, index) => {\n                                return <option key={index} value={label}>\n                                    {label}\n                                </option>\n                            })}\n                        </Select>)\n                    {/*<select>*/\n                    }\n                    {/*    <option value=\"\">{`${row.value.length} selected`}</option>*/\n                    }\n                    {/*    {featuresModelMetadata && featuresModelMetadata.labels.map((val, index) => {*/\n                    }\n                    {/*        return <option value={val} key={index}>{val}</option>;*/\n                    }\n                    {/*    })}*/\n                    }\n                    {/*</select>*/\n                    }\n                }\n            },\n            {\n                Header: 'VALUE',\n                accessor: 'value',\n            }\n        ]\n\n    }, [featuresModelMetadata.labels, featuresModelMetadata.domains]);\n\n    const getFeaturesData = useCallback(() => {\n        return fetchFeatures();\n    }, []);\n\n    const getModeMetadata = useCallback(() => {\n        return fetchModelMetadata();\n    }, []);\n\n    useEffect(() => {\n        getFeaturesData().then((res) => {\n            if(res) {\n                setFeaturesFlatData(res.map(item => {\n                    return {\n                        ...item,\n                        ...item.attributes\n                    }\n                }));\n            }\n        }).catch((err) => {\n            console.log(err)\n        });\n\n        getModeMetadata().then((res) => {\n            if(res) {\n                setFeaturesModelMetadata(res);\n            }\n        }).catch((err) => {\n            console.log(err)\n        });\n    }, []);\n\n    useEffect(() => {\n        setFeaturesColumns(featuresColumnArr)\n\n    }, [featuresFlatData, featuresModelMetadata]);\n\n    const filterFeaturesData = useMemo(() => {\n        return featuresFlatData.filter(feature => {\n            return (feature.name && feature.name.toLowerCase().indexOf(query.toLowerCase()) > -1) || (feature.description && feature.description.toLowerCase().indexOf(query.toLowerCase()) > -1)\n        })\n    }, [featuresFlatData, query]);\n\n    return !!featuresFlatData.length ? (\n        <div className=\"features-modal\">\n            <div onClick={() => {dispatch({type: 'SET_IS_DIALOG_OPEN',payload: {isDialogOpen: false}})}}>X</div>\n            <div>\n                <FeaturesFilters/>\n                <FeaturesTable columns={featuresColumns} data={filterFeaturesData}/>\n            </div>\n        </div> ): (\n        <div>Loading...</div>\n    )\n};\n\nexport default FeaturesModal;\n"]},"metadata":{},"sourceType":"module"}